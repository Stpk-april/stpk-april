<html>
<head>
<title>ダウンロード</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="style.css">
<link rel="stylesheet" type="text/css" href="ruby.css">
<link rel="shortcut icon" href="favicon.ico">
<link rel="icon" href="favicon.ico">
<script type="text/javascript" src="extras/jquery.min.1.7.js"></script>
<link rel="stylesheet" href="css/jquery.mCustomScrollbar.css">
<script src="js/lightbox.js"></script>
<script type="text/javascript" src="js/filesaver.js"></script>
<script type="text/javascript" src="js/jszip.js"></script>
<link rel="stylesheet" href="css/lightbox.css" />
<style type="text/css">

.lb-data .lb-closeContainer .lb-close{
	position:fixed !important;
	z-index:9999 !important;
	top:20px !important;
	left: 20px !important;
	right: auto !important;
}

input + label {
	color:white;
	display: inline-block;
	margin:3px;
    cursor: pointer;
	text-align:center;
	border: 2px solid rgba(0,0,0,0);
	-webkit-transition: all 0.3s;
	-moz-transition: all 0.3s;
	transition: all 0.3s;
}
input:checked + label { 
	border: 2px dotted rgba(255,255,255,1.0);
	background: #0B614B;
}

input {
	display:none;
}
 
 


</style>
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<!-- Save for Web Slices (back.psd) -->
<div style="position: absolute; top: 0px; left: 50px; height:100%; width: auto;">
<div id="align"> 
	<div id="content">
		<div class="box_ov">
			<div  id="box_in" style="height:675; width:950;margin: 0 30px;padding:30px;">		
			<h3> Twitterアイコン配信中！</h3>
			<button id="matome">選択したアイコンをまとめてzipダウンロード</button><br>
			<h5 id="err"> </h5>
			<form id="icons"></form>
			<h3> WEB体験版（？）公開中！</h3>
			<a href="images/game_dummy.jpg"  data-top="10px" data-iframe="test3.html" data-lightbox="game-1">
			<img src="images/fake.jpg" style="margin-left:240px">
			</a>
			<img src="images/null_t.png">
		</div>
		<div class="bottom_fade"></div>
		<div class="top_fade"></div>
		</div>
		<div class="box2">
			<a href="main.html" class="Button4 but02_06"></a>
			<a href="story.html" class="Button4 but02_01"></a>
			<a href="cha_ra.html" class="Button4 but02_02"></a>
			<a href="gallery.html" class="Button4 but02_03"></a>
			<a href="info.html" class="Button4 but02_04"></a>
			<a href="#" class="Button3 but02_05"></a>
			</div>
		<div class="box_side side-05">
		</div>
	</div>
	</div>
</div>



	<!-- custom scrollbar plugin -->
	<script src="js/jquery.mCustomScrollbar.concat.min.js"></script>	
	<script>
		(function($){
			$(window).load(function(){
				$("#box_in").mCustomScrollbar({
					autoHideScrollbar:true,
					theme:"rounded-dots"
				});
				
			});
			for(var i=1;i<=5;i++){
			$('<input id="checkbox'+i+'" type="checkbox" name="iconses" >').attr('value','icon'+i+'.png').appendTo('#icons');
			$('<label/>').appendTo('#icons').attr({'id':'label'+i,'for':'checkbox'+i+''}).css({'cursor':'pointer'});
			$('<img/>').appendTo('#label'+i).attr('src','images/icon/icon'+i+'.png').css({'width':'80px','height':'auto'});
			}
			$('#matome').click(function(){
			var zip = new JSZip();
			var idx=0;
			$("input:checkbox[name=iconses]:checked").each(function(){idx++});
			if(idx==0){
				$('#err').html('アイコンが選択されていません');
			}
			else{
				$('#err').html(idx+'個のアイコンをダウンロードします');
			}
			$("input:checkbox[name=iconses]:checked").each(function(i){
			var fle=$(this).val();
			var xhr = new XMLHttpRequest();
			xhr.open('GET', "images/icon/"+fle, true);
				xhr.responseType = "arraybuffer";
				xhr.onreadystatechange = function(evt) {
					if (xhr.readyState === 4) {
						if (xhr.status === 200) {
							zip.file(fle, xhr.response);
							if(i==(idx-1)){
								var content = zip.generate({type:"blob"});
								saveAs(content, "stpk_icons.zip");
							}
						}
					}
				};
				xhr.send();
				});
			});
		})(jQuery);
	</script>
<!--[if lt IE 7 ]> <body class="ie6"> <![endif]-->
<!--[if IE 7 ]>    <body class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <body class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <body class="ie9"> <![endif]-->
<!--[if (gt IE 9)]><body class="modern"> <![endif]-->
<!--[!(IE)]><!--><body class="notIE modern"> <!--<![endif]-->
</body>
</html>